# Chroma DB

**Chroma Overview:**
- Chroma is an in-memory vector database.
- It can save and load documents from a local machine, persisting data in a specified path.
- Chroma can be configured using Python with the `chromadb` library.

**Installation:**
```python
! pip install chromadb
import chromadb
```

**Client Initialization:**
```python
client = chromadb.PersistentClient('./chromadb_books')
# or for HTTP client
# client = chromadb.HttpClient(host='localhost', port='8000')
client.heartbeat()
```

**Collections:**
- Collections in Chroma are managed using the collection primitive.
- Naming rules for collections:
  1. Length: 3 to 63 characters.
  2. Start and end with a lowercase letter or digit.
  3. Dots, dashes, and underscores allowed in between.
  4. No consecutive dots.
  5. Not a valid IP address.

**Creating Collections:**
```python
collection = client.create_collection(name='harrypotter', metadata={'hnsw:space': 'cosine'})
```

**Embedding Functions:**
```python
from chromadb.utils import embedding_functions

sentence_transformer_ef = embedding_functions.SentenceTransformerEmbeddingFunction(model_name="paraphrase-albert-small-v2")

collection = client.create_collection(name='sample-books', metadata={'hnsw:space': 'cosine'}, embedding_function=sentence_transformer_ef)
```

**Querying and Deleting Collections:**
```python
collection = client.get_collection(name='harrypotter')
client.delete_collection(name='defence_against_dark_arts')
```

**Adding Documents to Collection:**
```python
defence_against_dark_arts = "..."  # (Text content)
charms = "..."
transfiguration = "..."
potions = "..."
collection.add(
    documents=[defence_against_dark_arts, charms, transfiguration, potions],
    metadatas=[{'name': 'defence_against_dark_arts'}, {'name': 'charms'}, {'name': 'transfiguration'}, {'name': 'potions'}],
    ids=[str(i) for i in range(4)]
)
```

**Querying Documents:**
```python
collection.query(
    query_texts=['nox'],
    n_results=3,
    where={'name': 'potions'},
    where_document={'$contains': 'cauldrons'}
)
```



**Random Sentences Example:**
```python
random_sentences = ["...", "...", "..."]  # (List of sentences)
collection.add(
    documents=random_sentences,
    ids=[str(i) for i in range(len(random_sentences))]
)
collection.query(
    query_texts=['stars'],
    n_results=1
)
```

**Additional Operations:**
```python
collection.delete(ids=['3'], where_document={'$contains': 'quiet'} and {'$contains': 'breeze'})
collection.peek()
collection.upsert(documents=random_sentences[2], ids=['2'])
collection.get(ids=['3'])
collection.update(ids=['3'], documents=random_sentences[3])
collection.get(ids=['3'])
```